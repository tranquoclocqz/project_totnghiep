<% stylesheet('admin_asset/css/morris.css') -%>
  <% stylesheet('admin_asset/media/css/dataTables.bootstrap.css') -%>
    <% stylesheet('admin_asset/media/css/dataTables.responsive.css') -%>
      <!--<script src="admin_asset/js/raphael-2.1.0-min.js"></script>
  <script src="admin_asset/js/morris-0.5.1.min.js"></script>-->
      <!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>-->
      <script src="admin_asset/js/raphael-2.1.0-min.js"></script>
      <script src="admin_asset/js/morris-0.5.1.min.js"></script>
      <div class='row main' style="margin:20px 0px 0px 0px">
        <div class="col-sm-10 col-sm-offset-2">
          <h4>Doanh thu</h4>
          <div class='form-inline'>
            <div class='form-group'>
              <input type="date" class="form-control">
            </div>
            <label>-</label>
            <div class='form-group'>
              <input type="date" class="form-control">
            </div>
            <div class='form-group'>
              <input type="submit" class="btn btn-default" id="tim" value="Tìm">
            </div>
          </div>
          <div id="myfirstchart" style="height: 250px;"></div>
        </div>
        <div class="col-sm-10 col-sm-offset-2">
          <h4>
            Danh sách đơn hàng
          </h4>
          <table class="table table-striped table-bordered table-hover" id="my_table">
            <thead>
              <th>Mã đơn hàng</th>
              <th>Tên khách hàng</th>
              <th>Giá trị</th>
              <th>Địa chỉ</th>
              <th>SĐT</th>
              <th>Ngày đặt hàng</th>
              <th>Trạng thái</th>
              <th>###</th>
            </thead>
            <tbody>
              <% hoadon.forEach(function(hd){ %>
                <tr>
                  <td>
                    <a href="/admin/donhang/<%= hd.donhang %>">
                      <%= hd.donhang %>
                    </a>
                  </td>
                  <td>
                    <%= hd.khachhang %>
                  </td>
                  <td>
                    <%= accounting.formatMoney(hd.giatri,options) %>
                  </td>
                  <td>
                    <%= hd.diachi %>
                  </td>
                  <td>
                    <%= hd.sodienthoai %>
                  </td>
                  <td>
                    <%= moment(hd.createdAt).locale('vi').format('LL') %>
                  </td>
                  <td>
                    <% if(hd.trangthai == 1){%>
                      <span class="label label-primary">Đang trong quá trình giao hàng</span>
                      <% }else{ %>
                        <span class="label label-success">Đã giao hàng</span>
                        <% } %>
                  </td>
                  <td>
                    <% if(hd.trangthai == 1){ %>
                      <a href="/admin/giaohang/<%= hd.id %>" class="btn btn-primary">Xác nhận</a>
                      <% } %></td>
                </tr>
                <% }) %>
            </tbody>
          </table>
        </div>
        <script>
          // var data = [
          //   { period: '2015-1-31', value: 30 },
          //   { period: '2015-2-20', value: 31 },
          //   { period: '2015-3-11', value: 3230 },
          //   { period: '2015-4-13', value: 310 },
          //   { period: '2015-5-3', value: 390 },
          //   { period: '2015-6-11', value: 310 },
          //   { period: '2015-7-2', value: 303 },
          // ];
          var data = [
            <% ds.forEach(function (data) { %>
              { period: '<%=moment(data.createdAt).format('YYYY[-]MM[-]DD')  %>', value: <%= data.giatri %> }, 
            <% }) %>
          ];
          new Morris.Line({
            data,
            // ID of the element in which to draw the chart.
            element: 'myfirstchart',
            // Chart data records -- each entry in this array corresponds to a point on
            // the chart.

            // The name of the data record attribute that contains x-values.
            xkey: 'period',
            // A list of names of data record attributes that contain y-values.
            ykeys: ['value'],
            // Labels for the ykeys -- will be displayed when you hover over the
            // chart.
            labels: ['Value'],
            xLabels: ['day'],

          });
        </script>
      </div>
      <% script('admin_asset/media/js/jquery.dataTables.min.js') -%>
        <% script('admin_asset/media/js/dataTables.bootstrap.min.js') -%>
          <script type="text/javascript">
            $(document).ready(function () {
              $("#my_table").DataTable({
                responsive: true
              });
            });
          </script>
          <script>
            // $(document).ready(function () {
            //   setInterval(function () {
            //     location.reload();
            //   }, 5000);
            // });
          </script>